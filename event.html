<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; background-color: #f4f7f6; padding: 40px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .date { color: #888; font-weight: bold; }
        h1 { font-size: 32px; margin: 10px 0 30px 0; border-bottom: 2px solid #00A3A0; padding-bottom: 15px; }
        .content { line-height: 1.8; font-size: 16px; white-space: pre-wrap; /* æ”¹è¡Œã‚’ãã®ã¾ã¾è¡¨ç¤º */ }
        .back-btn { display: inline-block; margin-top: 40px; text-decoration: none; color: #666; font-weight: bold; }
        .loading { text-align: center; color: #999; margin-top: 50px; }
    </style>
</head>
<body>

    <div class="container" id="detail-area">
        <p class="loading">èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <script>
        const supabaseUrl = 'https://daexakehxcvspmthpzzf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhZXhha2VoeGN2c3BtdGhwenpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMjc0ODgsImV4cCI6MjA4MzgwMzQ4OH0.xpHRjDPWlch_D80v1QQ9k_CJV6Q39pDa5f9qQ470rMI';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        async function fetchEventDetail() {
            // 1. URLã‹ã‚‰ã€Œidã€ã‚’å–ã‚Šå‡ºã™é­”æ³•
            const params = new URLSearchParams(window.location.search);
            const eventId = params.get('id');

            if (!eventId) {
                document.getElementById('detail-area').innerHTML = '<p>ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>';
                return;
            }

            // 2. ãã®IDã®ãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’Supabaseã‹ã‚‰æŒã£ã¦ãã‚‹
            const { data, error } = await supabaseClient
                .from('events')
                .select('*')
                .eq('id', eventId) // IDãŒä¸€è‡´ã™ã‚‹ã‚‚ã®
                .single();         // 1å€‹ã ã‘ã¡ã‚‡ã†ã ã„

            if (error) {
                document.getElementById('detail-area').innerText = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
            } else {
                // 3. ç”»é¢ã«è¡¨ç¤ºï¼
                document.getElementById('detail-area').innerHTML = `
                    <span class="date">ğŸ“… ${new Date(data.date).toLocaleDateString()}</span>
                    <h1>${data.title}</h1>
                    <div class="content">${data.description || 'è©³ç´°ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'}</div>
                    <a href="index.html" class="back-btn">â† ä¸€è¦§ã«æˆ»ã‚‹</a>
                `;
            }
        }

        fetchEventDetail();
    </script>
</body>
</html>
