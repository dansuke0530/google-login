<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; background-color: #f4f7f6; padding: 40px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        /* ç”»åƒè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .event-main-image { width: 100%; height: auto; max-height: 400px; object-fit: cover; border-radius: 8px; margin-bottom: 20px; display: none; /* ç”»åƒãŒã‚ã‚‹ã¨ãã ã‘è¡¨ç¤º */ }

        .date { color: #888; font-weight: bold; display: block; margin-bottom: 10px; }
        h1 { font-size: 32px; margin: 0 0 30px 0; border-bottom: 2px solid #00A3A0; padding-bottom: 15px; }
        .content { line-height: 1.8; font-size: 16px; white-space: pre-wrap; }
        .back-btn { display: inline-block; margin-top: 40px; text-decoration: none; color: #666; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container" id="detail-area">
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <script>
        const supabaseUrl = 'https://daexakehxcvspmthpzzf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhZXhha2VoeGN2c3BtdGhwenpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMjc0ODgsImV4cCI6MjA4MzgwMzQ4OH0.xpHRjDPWlch_D80v1QQ9k_CJV6Q39pDa5f9qQ470rMI';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        async function fetchEventDetail() {
            const params = new URLSearchParams(window.location.search);
            const eventId = params.get('id');

            if (!eventId) return document.getElementById('detail-area').innerHTML = '<p>ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>';

            const { data, error } = await supabaseClient.from('events').select('*').eq('id', eventId).single();

            if (error) {
                document.getElementById('detail-area').innerText = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
            } else {
                // ç”»åƒã‚¿ã‚°ã®æº–å‚™ï¼ˆç”»åƒãŒã‚ã‚Œã°srcã‚’å…¥ã‚Œã‚‹ï¼‰
                const imageTag = data.image_url 
                    ? `<img src="${data.image_url}" class="event-main-image" style="display:block;">` 
                    : '';

                document.getElementById('detail-area').innerHTML = `
                    ${imageTag}
                    <span class="date">ğŸ“… ${new Date(data.date).toLocaleDateString()}</span>
                    <h1>${data.title}</h1>
                    <div class="content">${data.description || 'è©³ç´°ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'}</div>
                    <a href="index.html" class="back-btn">â† ä¸€è¦§ã«æˆ»ã‚‹</a>
                `;
            }
        }
        fetchEventDetail();
    </script>
</body>
</html>
